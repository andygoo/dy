<!--_meta 作为公共模版分离出去-->
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="Bookmark" href="/favicon.ico" >
<link rel="Shortcut Icon" href="/favicon.ico" />
<!--[if lt IE 9]>
<script type="text/javascript" src="__PUBLIC__/admin/lib/html5shiv.js"></script>
<script type="text/javascript" src="__PUBLIC__/admin/lib/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/static/h-ui/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/lib/Hui-iconfont/1.0.8/iconfont.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/static/h-ui.admin/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/static/h-ui.admin/css/style.css" />
	<!--layer-->
	<link href="__PUBLIC__/admin/static/h-ui/js/layer/css/layui.css" rel="stylesheet">
	<script src="__PUBLIC__/admin/static/h-ui/js/layer/layui.js" charset="utf-8"></script>
<!--[if IE 6]>
<script type="text/javascript" src="__PUBLIC__/admin/lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
<!--/meta 作为公共模版分离出去-->

<title>添加用户 - H-ui.admin v3.1</title>
<meta name="keywords" content="H-ui.admin v3.1,H-ui网站后台模版,后台模版下载,后台管理系统模版,HTML后台模版下载">
<meta name="description" content="H-ui.admin v3.1，是一款由国人开发的轻量级扁平化网站后台模板，完全免费开源的网站后台管理系统模版，适合中小型CMS后台系统。">
</head>
<body>
<article class="page-container">
	<form action="{:U('Addidea/index')}" method="post" class="form form-horizontal" id="form-member-add">
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-1" style=" width:135px;"><span class="c-red">*</span>推广单元名称：</label>
			<div class="formControls col-xs-8 col-sm-5">
				{$u_name}
			</div>
			<input type="hidden" value="{$u_name}" name="c_utilname">
			<input type="hidden" value="{$id}" name="c_danid">
			<input type="hidden" value="{$did}" name="c_uid">
		</div>
		<div class="row cl" id="video">
			<label class="form-label col-xs-4 col-sm-1" style=" width: 155px;"><span class="c-red">*</span>创意视频：</label>
			<div class="formControls col-xs-8 col-sm-8">
				<button type="button" class="layui-btn" id="test5"><i class="layui-icon"></i>选择视频</button>
				<div class="layui-upload-list" style="display: inherit">
					<input type="hidden" id="videos" required="required" name="c_videourl"  value=""/>
					<a href="javascript:deletevide();" title="点击删除"><img style="display: none;" id="deletevideo" src="__PUBLIC__/admin/js/img/uploadify-cancel.png">
					</a>
					<video class="" onclick="playPause()" autoplay="autoplay"  id="demo" style="display: none;" width="250" heigt="200"/>
					<div id="imglist" style=" width:320px; height:150px; border:1px solid #cdcdcd; text-align:center; line-height:150px; vertical-align:middle;"> 视频大小请不要超过50M  </div>
				</div>
			</div>
		</div>
		<div class="row cl" id="image">
			<label class="form-label col-xs-4 col-sm-1"  style=" width: 155px;"><span class="c-red">*</span>创意图片(或者)：</label>
			<div class="formControls col-xs-8 col-sm-8">
				<button type="button" class="layui-btn" id="test1">上传图片</button>
				<span class="btn-upload form-group" style="height: auto;">
				<input type="hidden" id="uploadyinye" required="required" name="c_img" multiple="true" value=""/>
					<a href="javascript:deleteyinyeimg();" title="点击删除"><img style="display: none;margin-left: 120px;" id="deleteyinye" src="__PUBLIC__/admin/static/h-ui/images/uploadify-cancel.png">
					</a>
					<img class="layui-upload-img"  id="demo1" style="display: none;margin-left: -140px;" width="100" height="100">
					<p id="demoText1"></p>
				</span>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-1" style=" width: 135px;"><span class="c-red">*</span>创意名称：</label>
			<div class="formControls col-xs-8 col-sm-8">
				<input type="text" class="input-text" value="" placeholder="最长6个字" id="name" name="c_name" style="width: 350px; ">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-1" style=" width: 135px;"><span class="c-red">*</span>创意标题：</label>
			<div class="formControls col-xs-8 col-sm-8">
				<input type="text" class="input-text" value="" placeholder="最长20个字" id="title" name="c_title" style=" width: 350px;" />
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-1" style=" width: 135px;"><span class="c-red">*</span>创意链接：</label>
			<div class="formControls col-xs-8 col-sm-8">
				<input type="text" class="input-text" value="http://" placeholder="" id="url" name="c_url" style=" width: 350px;" />
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-1" style=" width: 135px;"><span class="c-red">*</span>广告按钮：</label>
			<div class="formControls col-xs-8 col-sm-8">
				<input type="text" class="input-text" value="立即点击" placeholder="" id="button" name="c_button" style=" width: 350px;" />
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-1" style=" width: 135px;"><span class="c-red">*</span>广告描述：</label>
			<div class="formControls col-xs-8 col-sm-8">
				<input type="text" class="input-text" value="" placeholder="" id="note" name="c_desc" style=" width: 350px;" />
			</div>
		</div>
		<div class="row cl">
			<div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-3">
				<a onclick="article_save_submit();" class="btn btn-primary radius"><i class="Hui-iconfont">&#xe632;</i> 提交</a>
			</div>
		</div>
	</form>
</article>

<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="__PUBLIC__/admin/lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/admin/lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="__PUBLIC__/admin/static/h-ui/js/H-ui.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/admin/static/h-ui.admin/js/H-ui.admin.js"></script> <!--/_footer 作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本--> 
<script type="text/javascript" src="__PUBLIC__/admin/lib/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" src="__PUBLIC__/admin/lib/jquery.validation/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" src="__PUBLIC__/admin/lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="__PUBLIC__/admin/lib/jquery.validation/1.14.0/messages_zh.js"></script>
<script>
    layui.use('upload', function(){
        var $ = layui.jquery
            ,upload = layui.upload;
        upload.render({
            elem: '#test5'
            ,url:"{:U('image/uploadvideo')}"
            ,accept: 'video' //视频
            ,done: function(res){
                console.log(res.data)
                $("#videos").attr('value',"uploadvideo/"+res.data);
                $("#demo").attr('src',"__PUBLIC__/uploadvideo/"+res.data);
                $('#demo').show();
                $('#deletevideo').show();
                $('#image').hide();
            }
        });
        //图片上传
        var uploadInst1 = upload.render({
            elem: '#test1'
            ,url: "{:U('image/uploadfortp')}"
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                obj.preview(function(index, file, result){
                    $('#demo1').attr('src', result); //图片链接（base64）
                });
            }
            ,done: function(res){
                //如果上传失败
                if(res.code > 0){
                    $('#video').show();
                    return layer.msg('上传失败');

                }
                $('#video').hide();
                console.log(res);
                //var obj=JSON.parse(res);
                console.log(res.data);
                $("#uploadyinye").attr('value',"admin/uploads/"+res.data);
                $('#deleteyinye').show();
                $('#demo1').show();
                //上传成功
            }
            ,error: function(){
                //演示失败状态，并实现重传
                var demoText = $('#demoText1');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function(){
                    uploadInst1.upload();
                });
            }
        });
    });
</script>
<script>
    function deletevide() {
        var src=$('#demo').attr('src');
        //alert(src);
        $.ajax({
            type: "POST", //访问WebService使用Post方式请求
            url: "{:U('Addidea/del')}", //调用WebService的地址和方法名称组合---WsURL/方法名
            data: "src=" + src,
            success: function(data){
                console.log(data);
            }
        });
        $("#videos").attr('value','');
        $("#demo").attr('src','');
        $('#deletevideo').hide();
        $('#demo').hide();
        $('#image').show();

    }
</script>
<script type="text/javascript">
$(function(){
	$('.skin-minimal input').iCheck({
		checkboxClass: 'icheckbox-blue',
		radioClass: 'iradio-blue',
		increaseArea: '20%'
	});

});
function playPause() {
    var myVideo = document.getElementsByTagName('video')[0];
    if (myVideo.paused){
        myVideo.play();
    }
    else{
        myVideo.pause();
    }
}
function deleteyinyeimg() {
    $("#uploadyinye").attr('value','');
    $("#demo1").attr('src','');
    $('#deleteyinye').hide();
    $('#demo1').hide();
    $('#video').show();
}
</script>

<script>
    function article_save_submit() {
        if($('#name').val().length<=0){
            alert('名称不可为空');
            return false;
		}else if($('#title').val().length<=0){
            alert('标题不可为空');
            return false;
        }else if($('#url').val().length<=0){
            alert('创意链接不可为空');
            return false;
        }else if($('#button').val().length<=0){
            alert('广告按钮不可为空');
            return false;
        }else{
            $('form').submit();
            alert('添加成功，请刷新即可');
			window.location.reload();
		}

    }
</script>
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>